{"id":4659,"date":"2020-12-09T00:17:20","date_gmt":"2020-12-08T18:47:20","guid":{"rendered":"https:\/\/golangbyexamples.com\/?p=4659"},"modified":"2020-12-14T23:45:29","modified_gmt":"2020-12-14T18:15:29","slug":"set-resposne-headers-http-go","status":"publish","type":"post","link":"https:\/\/golangbyexamples.com\/set-resposne-headers-http-go\/","title":{"rendered":"Set response headers for an incoming HTTP request in Go (Golang)"},"content":{"rendered":"\n<p class=\"has-medium-font-size\">Note: Related Post<\/p>\n\n\n\n<ul class=\"has-medium-font-size wp-block-list\"><li>Get headers from an incoming HTTP request in Go &#8211; <a href=\"https:\/\/golangbyexamples.com\/headers-http-request-golang\/\">https:\/\/golangbyexamples.com\/headers-http-request-golang\/<\/a><\/li><\/ul>\n\n\n\n<ul class=\"has-medium-font-size wp-block-list\"><li>Get response headers for an outgoing HTTP request in Golang- <a href=\"https:\/\/golangbyexamples.com\/get-response-headers-making-go\/\">https:\/\/golangbyexamples.com\/get-response-headers-making-go\/<\/a><\/li><\/ul>\n\n\n\n<ul class=\"has-medium-font-size wp-block-list\"><li>Set headers for an outgoing HTTP request in Go (Golang) &#8211; <a href=\"https:\/\/golangbyexamples.com\/set-headers-http-request\/\">https:\/\/golangbyexamples.com\/set-headers-http-request\/<\/a><\/li><\/ul>\n\n\n\n<p class=\"has-medium-font-size\">Now let&#8217;s look at how we can set response headers in an incoming HTTP request<\/p>\n\n\n\n<div id=\"ez-toc-container\" class=\"ez-toc-v2_0_17 counter-hierarchy counter-decimal ez-toc-light-blue\">\n<div class=\"ez-toc-title-container\">\n<p class=\"ez-toc-title\">Table of Contents<\/p>\n<span class=\"ez-toc-title-toggle\"><a class=\"ez-toc-pull-right ez-toc-btn ez-toc-btn-xs ez-toc-btn-default ez-toc-toggle\" style=\"display: none;\"><i class=\"ez-toc-glyphicon ez-toc-icon-toggle\"><\/i><\/a><\/span><\/div>\n<nav><ul class=\"ez-toc-list ez-toc-list-level-1\"><li class=\"ez-toc-page-1 ez-toc-heading-level-1\"><a class=\"ez-toc-link ez-toc-heading-1\" href=\"https:\/\/golangbyexamples.com\/set-resposne-headers-http-go\/#Overview\" title=\"Overview\">Overview<\/a><\/li><li class=\"ez-toc-page-1 ez-toc-heading-level-1\"><a class=\"ez-toc-link ez-toc-heading-2\" href=\"https:\/\/golangbyexamples.com\/set-resposne-headers-http-go\/#Using_wHeaderAdd_method\" title=\"Using w.Header().Add() method\">Using w.Header().Add() method<\/a><\/li><li class=\"ez-toc-page-1 ez-toc-heading-level-1\"><a class=\"ez-toc-link ez-toc-heading-3\" href=\"https:\/\/golangbyexamples.com\/set-resposne-headers-http-go\/#Using_wHeaderSet_method\" title=\"Using w.Header().Set method\">Using w.Header().Set method<\/a><\/li><li class=\"ez-toc-page-1 ez-toc-heading-level-1\"><a class=\"ez-toc-link ez-toc-heading-4\" href=\"https:\/\/golangbyexamples.com\/set-resposne-headers-http-go\/#Example\" title=\"Example\">Example<\/a><\/li><\/ul><\/nav><\/div>\n<h1 class=\"wp-block-heading\"><span class=\"ez-toc-section\" id=\"Overview\"><\/span><strong>Overview<\/strong><span class=\"ez-toc-section-end\"><\/span><\/h1>\n\n\n\n<p class=\"has-medium-font-size\">Below is the format in which a Header is represented in go.<\/p>\n\n\n\n<pre class=\"wp-block-prismatic-blocks\"><code class=\"language-go\">type Header map[string][]string<\/code><\/pre>\n\n\n\n<p class=\"has-medium-font-size\">So the header is a key value pair with<\/p>\n\n\n\n<ul class=\"has-medium-font-size wp-block-list\"><li>key being represented in canonical form. Canonical form means that first character and any character following a hyphen is in uppercase. All other characters is in lowercase. Example of canonical forms are<\/li><\/ul>\n\n\n\n<pre class=\"wp-block-prismatic-blocks\"><code class=\"language-go\">Content-Type\nAccept-Encoding<\/code><\/pre>\n\n\n\n<ul class=\"has-medium-font-size wp-block-list\"><li>Value is represented as a slice of string. Why array of strings? Because it is perfectly okay to two headers with same key and different values in a request. Both the values will be collected in the slice.<\/li><\/ul>\n\n\n\n<p class=\"has-medium-font-size\">For eg if below headers are set in the outgoing response from a server then<\/p>\n\n\n\n<pre class=\"wp-block-prismatic-blocks\"><code class=\"language-go\">content-type: applcation\/json\nfoo: bar1\nfoo: bar2<\/code><\/pre>\n\n\n\n<p class=\"has-medium-font-size\">Then at client the headers will look like<\/p>\n\n\n\n<pre class=\"wp-block-prismatic-blocks\"><code class=\"language-go\">Content-Type: applcation\/json\nFoo: bar1\nFoo: bar2<\/code><\/pre>\n\n\n\n<p class=\"has-medium-font-size\">Notice that:<\/p>\n\n\n\n<ul class=\"has-medium-font-size wp-block-list\"><li><strong>content-type<\/strong> is converted to canonical form <strong>Content-Type<\/strong><\/li><\/ul>\n\n\n\n<ul class=\"has-medium-font-size wp-block-list\"><li><strong>foo<\/strong> header is converted to <strong>Foo<\/strong>. Also note that there will be two headers in the response with the same key which is <strong>foo<\/strong>. The values will be <strong>bar1<\/strong> and <strong>bar2<\/strong><\/li><\/ul>\n\n\n\n<p class=\"has-medium-font-size\">Now we have seen how a header is represented in the request. Let&#8217;s see how we can set the response headers values. Assume we have the below key value pairs of headers which we have to set in the response headers<\/p>\n\n\n\n<pre class=\"wp-block-prismatic-blocks\"><code class=\"language-go\">content-type: applcation\/json\nfoo: bar1\nfoo: bar2<\/code><\/pre>\n\n\n\n<p class=\"has-medium-font-size\">There is a <strong>Header<\/strong> method defined in the <strong>http.ResponseWriter<\/strong> interface as below. It returns the Header associated with the response.<\/p>\n\n\n\n<pre class=\"wp-block-prismatic-blocks\"><code class=\"language-go\">type ResponseWriter interface {\n    Header() Header\n    ...\n}<\/code><\/pre>\n\n\n\n<p class=\"has-medium-font-size\">In the below example let&#8217;s assume that variable <strong>w<\/strong> is of type <strong>http.ResponseWriter <\/strong>. Now let&#8217;s see different ways of setting a header<\/p>\n\n\n\n<h1 class=\"wp-block-heading\"><span class=\"ez-toc-section\" id=\"Using_wHeaderAdd_method\"><\/span><strong>Using w.Header().Add() method<\/strong><span class=\"ez-toc-section-end\"><\/span><\/h1>\n\n\n\n<p class=\"has-medium-font-size\">Below is the signature of the Add method<\/p>\n\n\n\n<pre class=\"wp-block-prismatic-blocks\"><code class=\"language-go\">func (h Header) Add(key, value string)<\/code><\/pre>\n\n\n\n<p class=\"has-medium-font-size\">This method is used to add the key value pair to the response header. We have already seen above that Header value can be array as well. So this method appends to the existing values that might already have been associated with the key.&nbsp; Also the key will be converted to canonical form.<\/p>\n\n\n\n<p class=\"has-medium-font-size\">For example if we add the foo header two times with different values<\/p>\n\n\n\n<pre class=\"wp-block-prismatic-blocks\"><code class=\"language-go\">w.Header().Add(\"foo\", \"bar1\")\nw.Header().Add(\"foo\", \"bar2\")<\/code><\/pre>\n\n\n\n<p class=\"has-medium-font-size\">Then <strong>foo<\/strong> header will be set to<strong> [&#8220;bar1&#8221;, &#8220;bar2&#8221;]. <\/strong>Also <strong>foo<\/strong> will become <strong>Foo<\/strong> when sending response to the client.<\/p>\n\n\n\n<h1 class=\"wp-block-heading\"><span class=\"ez-toc-section\" id=\"Using_wHeaderSet_method\"><\/span><strong>Using w.Header().Set method<\/strong><span class=\"ez-toc-section-end\"><\/span><\/h1>\n\n\n\n<p class=\"has-medium-font-size\">Below is the signature of the function<\/p>\n\n\n\n<pre class=\"wp-block-prismatic-blocks\"><code class=\"language-go\">func (h Header) Set(key, value string)<\/code><\/pre>\n\n\n\n<p class=\"has-medium-font-size\">It can be used to set the header entries associated with the given key. Unlike the <strong>Add<\/strong> method, this method will replace any existing values associated with the key. Also the key will be converted to canonical form.<\/p>\n\n\n\n<h1 class=\"wp-block-heading\"><span class=\"ez-toc-section\" id=\"Example\"><\/span><strong>Example<\/strong><span class=\"ez-toc-section-end\"><\/span><\/h1>\n\n\n\n<p class=\"has-medium-font-size\">Let&#8217;s see a program illustrating all the above points<\/p>\n\n\n\n<pre class=\"wp-block-prismatic-blocks\"><code class=\"language-go\">package main\n\nimport (\n\t\"encoding\/json\"\n\t\"net\/http\"\n)\n\nfunc main() {\n\thandler := http.HandlerFunc(handleRequest)\n\thttp.Handle(\"\/example\", handler)\n\thttp.ListenAndServe(\":8085\", nil)\n}\n\nfunc handleRequest(w http.ResponseWriter, r *http.Request) {\n\tw.Header().Set(\"content-type\", \"application\/json\")\n\n\tw.Header().Add(\"foo\", \"bar1\")\n\tw.Header().Add(\"foo\", \"bar2\")\n\n\tresp := make(map[string]string)\n\tresp[\"message\"] = \"success\"\n\tjsonResp, _ := json.Marshal(resp)\n\tw.Write(jsonResp)\n}<\/code><\/pre>\n\n\n\n<p class=\"has-medium-font-size\">In above program we started a server which is listening on port 8085. Also we are setting the <strong>content-type<\/strong> header as below<\/p>\n\n\n\n<pre class=\"wp-block-prismatic-blocks\"><code class=\"language-go\">w.Header().Set(\"content-type\", \"application\/json\")<\/code><\/pre>\n\n\n\n<p class=\"has-medium-font-size\">Also we are setting the <strong>foo<\/strong> header as below<\/p>\n\n\n\n<pre class=\"wp-block-prismatic-blocks\"><code class=\"language-go\">w.Header().Add(\"foo\", \"bar1\")\nw.Header().Add(\"foo\", \"bar2\")<\/code><\/pre>\n\n\n\n<p class=\"has-medium-font-size\">We also defined a URL on that endpoint. Run this server and make the below API call.<\/p>\n\n\n\n<pre class=\"wp-block-prismatic-blocks\"><code class=\"language-go\">curl -v -X POST http:\/\/localhost:8085\/example<\/code><\/pre>\n\n\n\n<p class=\"has-medium-font-size\">After running this API check the response headers in the terminal. It is exactly as we have discussed. Also each of the header key is converted to its canonical form.<\/p>\n\n\n\n<pre class=\"wp-block-prismatic-blocks\"><code class=\"language-go\">< HTTP\/1.1 200 OK\n< Content-Type: application\/json\n< Foo: bar1\n< Foo: bar2\n< Content-Length: 21\n< \n* Connection #0 to host localhost left intact\n{\"message\":\"success\"}<\/code><\/pre>\n","protected":false},"excerpt":{"rendered":"<p>Note: Related Post Get headers from an incoming HTTP request in Go &#8211; https:\/\/golangbyexamples.com\/headers-http-request-golang\/ Get response headers for an outgoing HTTP request in Golang- https:\/\/golangbyexamples.com\/get-response-headers-making-go\/ Set headers for an outgoing HTTP request&#8230;<\/p>\n","protected":false},"author":1,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"spay_email":"","footnotes":"","jetpack_publicize_message":"","jetpack_is_tweetstorm":false},"categories":[1],"tags":[3,4],"class_list":["post-4659","post","type-post","status-publish","format-standard","hentry","category-tech","tag-go","tag-golang"],"yoast_head":"<!-- This site is optimized with the Yoast SEO plugin v22.7 - https:\/\/yoast.com\/wordpress\/plugins\/seo\/ -->\n<title>Set response headers for an incoming HTTP request in Go (Golang) - Welcome To Golang By Example<\/title>\n<meta name=\"robots\" content=\"index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1\" \/>\n<link rel=\"canonical\" href=\"https:\/\/golangbyexamples.com\/set-resposne-headers-http-go\/\" \/>\n<meta property=\"og:locale\" content=\"en_US\" \/>\n<meta property=\"og:type\" content=\"article\" \/>\n<meta property=\"og:title\" content=\"Set response headers for an incoming HTTP request in Go (Golang) - Welcome To Golang By Example\" \/>\n<meta property=\"og:description\" content=\"Note: Related Post Get headers from an incoming HTTP request in Go &#8211; https:\/\/golangbyexamples.com\/headers-http-request-golang\/ Get response headers for an outgoing HTTP request in Golang- https:\/\/golangbyexamples.com\/get-response-headers-making-go\/ Set headers for an outgoing HTTP request...\" \/>\n<meta property=\"og:url\" content=\"https:\/\/golangbyexamples.com\/set-resposne-headers-http-go\/\" \/>\n<meta property=\"og:site_name\" content=\"Welcome To Golang By Example\" \/>\n<meta property=\"article:published_time\" content=\"2020-12-08T18:47:20+00:00\" \/>\n<meta property=\"article:modified_time\" content=\"2020-12-14T18:15:29+00:00\" \/>\n<meta name=\"author\" content=\"admin\" \/>\n<meta name=\"twitter:card\" content=\"summary_large_image\" \/>\n<meta name=\"twitter:label1\" content=\"Written by\" \/>\n\t<meta name=\"twitter:data1\" content=\"admin\" \/>\n\t<meta name=\"twitter:label2\" content=\"Est. reading time\" \/>\n\t<meta name=\"twitter:data2\" content=\"4 minutes\" \/>\n<script type=\"application\/ld+json\" class=\"yoast-schema-graph\">{\"@context\":\"https:\/\/schema.org\",\"@graph\":[{\"@type\":\"WebPage\",\"@id\":\"https:\/\/golangbyexamples.com\/set-resposne-headers-http-go\/\",\"url\":\"https:\/\/golangbyexamples.com\/set-resposne-headers-http-go\/\",\"name\":\"Set response headers for an incoming HTTP request in Go (Golang) - Welcome To Golang By Example\",\"isPartOf\":{\"@id\":\"https:\/\/golangbyexamples.com\/#website\"},\"datePublished\":\"2020-12-08T18:47:20+00:00\",\"dateModified\":\"2020-12-14T18:15:29+00:00\",\"author\":{\"@id\":\"https:\/\/golangbyexamples.com\/#\/schema\/person\/8833ea7638dafd763cb1db6c0ca4576f\"},\"breadcrumb\":{\"@id\":\"https:\/\/golangbyexamples.com\/set-resposne-headers-http-go\/#breadcrumb\"},\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"ReadAction\",\"target\":[\"https:\/\/golangbyexamples.com\/set-resposne-headers-http-go\/\"]}]},{\"@type\":\"BreadcrumbList\",\"@id\":\"https:\/\/golangbyexamples.com\/set-resposne-headers-http-go\/#breadcrumb\",\"itemListElement\":[{\"@type\":\"ListItem\",\"position\":1,\"name\":\"Home\",\"item\":\"https:\/\/golangbyexamples.com\/\"},{\"@type\":\"ListItem\",\"position\":2,\"name\":\"Set response headers for an incoming HTTP request in Go (Golang)\"}]},{\"@type\":\"WebSite\",\"@id\":\"https:\/\/golangbyexamples.com\/#website\",\"url\":\"https:\/\/golangbyexamples.com\/\",\"name\":\"Welcome To Golang By Example\",\"description\":\"\",\"potentialAction\":[{\"@type\":\"SearchAction\",\"target\":{\"@type\":\"EntryPoint\",\"urlTemplate\":\"https:\/\/golangbyexamples.com\/?s={search_term_string}\"},\"query-input\":\"required name=search_term_string\"}],\"inLanguage\":\"en-US\"},{\"@type\":\"Person\",\"@id\":\"https:\/\/golangbyexamples.com\/#\/schema\/person\/8833ea7638dafd763cb1db6c0ca4576f\",\"name\":\"admin\",\"image\":{\"@type\":\"ImageObject\",\"inLanguage\":\"en-US\",\"@id\":\"https:\/\/golangbyexamples.com\/#\/schema\/person\/image\/\",\"url\":\"https:\/\/secure.gravatar.com\/avatar\/?s=96&d=mm&r=g\",\"contentUrl\":\"https:\/\/secure.gravatar.com\/avatar\/?s=96&d=mm&r=g\",\"caption\":\"admin\"},\"url\":\"https:\/\/golangbyexamples.com\/author\/admin\/\"}]}<\/script>\n<!-- \/ Yoast SEO plugin. -->","yoast_head_json":{"title":"Set response headers for an incoming HTTP request in Go (Golang) - Welcome To Golang By Example","robots":{"index":"index","follow":"follow","max-snippet":"max-snippet:-1","max-image-preview":"max-image-preview:large","max-video-preview":"max-video-preview:-1"},"canonical":"https:\/\/golangbyexamples.com\/set-resposne-headers-http-go\/","og_locale":"en_US","og_type":"article","og_title":"Set response headers for an incoming HTTP request in Go (Golang) - Welcome To Golang By Example","og_description":"Note: Related Post Get headers from an incoming HTTP request in Go &#8211; https:\/\/golangbyexamples.com\/headers-http-request-golang\/ Get response headers for an outgoing HTTP request in Golang- https:\/\/golangbyexamples.com\/get-response-headers-making-go\/ Set headers for an outgoing HTTP request...","og_url":"https:\/\/golangbyexamples.com\/set-resposne-headers-http-go\/","og_site_name":"Welcome To Golang By Example","article_published_time":"2020-12-08T18:47:20+00:00","article_modified_time":"2020-12-14T18:15:29+00:00","author":"admin","twitter_card":"summary_large_image","twitter_misc":{"Written by":"admin","Est. reading time":"4 minutes"},"schema":{"@context":"https:\/\/schema.org","@graph":[{"@type":"WebPage","@id":"https:\/\/golangbyexamples.com\/set-resposne-headers-http-go\/","url":"https:\/\/golangbyexamples.com\/set-resposne-headers-http-go\/","name":"Set response headers for an incoming HTTP request in Go (Golang) - Welcome To Golang By Example","isPartOf":{"@id":"https:\/\/golangbyexamples.com\/#website"},"datePublished":"2020-12-08T18:47:20+00:00","dateModified":"2020-12-14T18:15:29+00:00","author":{"@id":"https:\/\/golangbyexamples.com\/#\/schema\/person\/8833ea7638dafd763cb1db6c0ca4576f"},"breadcrumb":{"@id":"https:\/\/golangbyexamples.com\/set-resposne-headers-http-go\/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https:\/\/golangbyexamples.com\/set-resposne-headers-http-go\/"]}]},{"@type":"BreadcrumbList","@id":"https:\/\/golangbyexamples.com\/set-resposne-headers-http-go\/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https:\/\/golangbyexamples.com\/"},{"@type":"ListItem","position":2,"name":"Set response headers for an incoming HTTP request in Go (Golang)"}]},{"@type":"WebSite","@id":"https:\/\/golangbyexamples.com\/#website","url":"https:\/\/golangbyexamples.com\/","name":"Welcome To Golang By Example","description":"","potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https:\/\/golangbyexamples.com\/?s={search_term_string}"},"query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"Person","@id":"https:\/\/golangbyexamples.com\/#\/schema\/person\/8833ea7638dafd763cb1db6c0ca4576f","name":"admin","image":{"@type":"ImageObject","inLanguage":"en-US","@id":"https:\/\/golangbyexamples.com\/#\/schema\/person\/image\/","url":"https:\/\/secure.gravatar.com\/avatar\/?s=96&d=mm&r=g","contentUrl":"https:\/\/secure.gravatar.com\/avatar\/?s=96&d=mm&r=g","caption":"admin"},"url":"https:\/\/golangbyexamples.com\/author\/admin\/"}]}},"jetpack_featured_media_url":"","jetpack_publicize_connections":[],"jetpack_sharing_enabled":true,"jetpack_shortlink":"https:\/\/wp.me\/paOs1b-1d9","amp_validity":null,"amp_enabled":true,"_links":{"self":[{"href":"https:\/\/golangbyexamples.com\/wp-json\/wp\/v2\/posts\/4659","targetHints":{"allow":["GET"]}}],"collection":[{"href":"https:\/\/golangbyexamples.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/golangbyexamples.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/golangbyexamples.com\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/golangbyexamples.com\/wp-json\/wp\/v2\/comments?post=4659"}],"version-history":[{"count":10,"href":"https:\/\/golangbyexamples.com\/wp-json\/wp\/v2\/posts\/4659\/revisions"}],"predecessor-version":[{"id":4724,"href":"https:\/\/golangbyexamples.com\/wp-json\/wp\/v2\/posts\/4659\/revisions\/4724"}],"wp:attachment":[{"href":"https:\/\/golangbyexamples.com\/wp-json\/wp\/v2\/media?parent=4659"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/golangbyexamples.com\/wp-json\/wp\/v2\/categories?post=4659"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/golangbyexamples.com\/wp-json\/wp\/v2\/tags?post=4659"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}