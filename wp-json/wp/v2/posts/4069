{"id":4069,"date":"2020-09-23T19:36:08","date_gmt":"2020-09-23T14:06:08","guid":{"rendered":"https:\/\/golangbyexamples.com\/?p=4069"},"modified":"2020-09-23T19:36:22","modified_gmt":"2020-09-23T14:06:22","slug":"defer-methods-golang","status":"publish","type":"post","link":"https:\/\/golangbyexamples.com\/defer-methods-golang\/","title":{"rendered":"Defer and Methods in Go (Golang)"},"content":{"rendered":"\n<div id=\"ez-toc-container\" class=\"ez-toc-v2_0_17 counter-hierarchy counter-decimal ez-toc-light-blue\">\n<div class=\"ez-toc-title-container\">\n<p class=\"ez-toc-title\">Table of Contents<\/p>\n<span class=\"ez-toc-title-toggle\"><a class=\"ez-toc-pull-right ez-toc-btn ez-toc-btn-xs ez-toc-btn-default ez-toc-toggle\" style=\"display: none;\"><i class=\"ez-toc-glyphicon ez-toc-icon-toggle\"><\/i><\/a><\/span><\/div>\n<nav><ul class=\"ez-toc-list ez-toc-list-level-1\"><li class=\"ez-toc-page-1 ez-toc-heading-level-1\"><a class=\"ez-toc-link ez-toc-heading-1\" href=\"https:\/\/golangbyexamples.com\/defer-methods-golang\/#Overview\" title=\"Overview\">Overview<\/a><\/li><li class=\"ez-toc-page-1 ez-toc-heading-level-1\"><a class=\"ez-toc-link ez-toc-heading-2\" href=\"https:\/\/golangbyexamples.com\/defer-methods-golang\/#Example\" title=\"Example\">Example<\/a><\/li><\/ul><\/nav><\/div>\n<h1 class=\"wp-block-heading\"><span class=\"ez-toc-section\" id=\"Overview\"><\/span><strong>Overview<\/strong><span class=\"ez-toc-section-end\"><\/span><\/h1>\n\n\n\n<p class=\"has-medium-font-size\"><strong>defer<\/strong> statement is also applicable\u00a0 for methods in a similar way it is applicable to functions. Let&#8217;s see an example<\/p>\n\n\n\n<h1 class=\"wp-block-heading\"><span class=\"ez-toc-section\" id=\"Example\"><\/span><strong>Example<\/strong><span class=\"ez-toc-section-end\"><\/span><\/h1>\n\n\n\n<pre class=\"wp-block-prismatic-blocks\"><code class=\"language-go\">package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"os\"\n)\n\nfunc main() {\n    err := writeToTempFile(\"Some text\")\n    if err != nil {\n        log.Fatalf(err.Error())\n    }\n    fmt.Printf(\"Write to file succesful\")\n}\n\nfunc writeToTempFile(text string) error {\n    file, err := os.Open(\"temp.txt\")\n    if err != nil {\n        return err\n    }\n    defer file.Close()\n\n    n, err := file.WriteString(\"Some text\")\n    if err != nil {\n        return err\n    }\n    fmt.Printf(\"Number of bytes written: %d\", n)\n    return nil\n}<\/code><\/pre>\n\n\n\n<p class=\"has-medium-font-size\">In the above program, we do <strong>defer file.Close()<\/strong> after opening the file. <strong>Close<\/strong> is the method which is defined on the <strong>file<\/strong> instance. This will make sure that closing of the file is executed even if the write to the file results into an error. Defer function makes sure that the file will be closed regardless of number of return statements in the function.<\/p>\n\n\n\n<p class=\"has-medium-font-size\">Let&#8217;s see another example of a method called on a custom struct in a defer function<\/p>\n\n\n\n<pre class=\"wp-block-prismatic-blocks\"><code class=\"language-go\">package main\n\nimport (\n\t\"errors\"\n\t\"fmt\"\n)\n\ntype employee struct {\n\tname string\n}\n\nfunc (e *employee) setName(name string) error {\n\tdefer e.setDefaultName()\n\tif len(name) < 3 {\n\t\tfmt.Println(\"Length of name passed is less than 3\")\n\t\treturn errors.New(\"Length of name cannnot be less than 3\")\n\t}\n\te.name = name\n\treturn nil\n}\n\nfunc (e *employee) setDefaultName() {\n        fmt.Println(\"In the setDefaultName function\")\n\tif e.name == \"\" {\n\t\te.name = \"DefaultName\"\n\t\tfmt.Println(\"Default name is set\")\n\t}\n}\n\nfunc main() {\n\te1 := &#038;employee{}\n\te1.setName(\"John\")\n\tfmt.Printf(\"First employee name is: %s\\n\", e1.name)\n\n\tfmt.Println()\n\te2 := &#038;employee{}\n\te2.setName(\"Ko\")\n\tfmt.Printf(\"Second employee name is: %s\\n\", e2.name)\n\treturn\n}<\/code><\/pre>\n\n\n\n<p class=\"has-medium-font-size\"><strong>Output<\/strong><\/p>\n\n\n\n<pre class=\"wp-block-prismatic-blocks\"><code class=\"language-go\">In the setDefaultName function\nFirst employee name is: John\n\nLength of name passed is less than 3\nIn the setDefaultName function\nDefault name is set\nSecond employee name is: DefaultName<\/code><\/pre>\n\n\n\n<p class=\"has-medium-font-size\">In the above program we have a custom struct <strong>employee<\/strong><\/p>\n\n\n\n<pre class=\"wp-block-prismatic-blocks\"><code class=\"language-go\">type employee struct {\n\tname string\n}<\/code><\/pre>\n\n\n\n<p class=\"has-medium-font-size\">struct employee has a <strong>setName <\/strong>function which sets the name. But this function also raises an error is length of name passed is less than 3.\u00a0 We have a defer function in the <strong>setName <\/strong>which executes after <strong>setName<\/strong> finishes and checks weather the name is empty. If it is empty then it sets a default name. This defer function is actually a method <strong>setDefaultName<\/strong><\/p>\n\n\n\n<pre class=\"wp-block-prismatic-blocks\"><code class=\"language-go\">func (e *employee) setDefaultName() {\n\tif e.name == \"\" {\n\t\te.name = \"DefaultName\"\n\t\tfmt.Println(\"Default name is set\")\n\t}\n}<\/code><\/pre>\n\n\n\n<p class=\"has-medium-font-size\">Then we create an instance of employee e1 and sets its name<\/p>\n\n\n\n<p class=\"has-medium-font-size\">Since length of \"John\" is greater than 3, the <strong>setName <\/strong>function doesn't raises an error. But if you will notice the output,\u00a0 the defer function <strong>setDefaultName<\/strong> is still executed<\/p>\n\n\n\n<pre class=\"wp-block-prismatic-blocks\"><code class=\"language-go\">In the setDefaultName function\nFirst employee name is: John<\/code><\/pre>\n\n\n\n<p class=\"has-medium-font-size\">Then we create an instance of employee <strong>e2<\/strong> and sets its name<\/p>\n\n\n\n<pre class=\"wp-block-prismatic-blocks\"><code class=\"language-go\">e1 := &employee{}\ne1.setName(\"Ko\")<\/code><\/pre>\n\n\n\n<p class=\"has-medium-font-size\">Since length of \"Ko\" is less than 3, the <strong>setName <\/strong>function raises\u00a0 an error. defer function <strong>setDefaultName<\/strong> also gets executed in this case and it sets the default name. That is why you see below output in this case<\/p>\n\n\n\n<pre class=\"wp-block-prismatic-blocks\"><code class=\"language-go\">Length of name passed is less than 3\nIn the setDefaultName function\nDefault name is set\nSecond employee name is: DefaultNam<\/code><\/pre>\n","protected":false},"excerpt":{"rendered":"<p>Table of Contents OverviewExample Overview defer statement is also applicable\u00a0 for methods in a similar way it is applicable to functions. Let&#8217;s see an example Example In the above program, we do&#8230;<\/p>\n","protected":false},"author":1,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"spay_email":"","footnotes":"","jetpack_publicize_message":"","jetpack_is_tweetstorm":false},"categories":[1],"tags":[3,4],"class_list":["post-4069","post","type-post","status-publish","format-standard","hentry","category-tech","tag-go","tag-golang"],"yoast_head":"<!-- This site is optimized with the Yoast SEO plugin v22.7 - https:\/\/yoast.com\/wordpress\/plugins\/seo\/ -->\n<title>Defer and Methods in Go (Golang) - Welcome To Golang By Example<\/title>\n<meta name=\"robots\" content=\"index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1\" \/>\n<link rel=\"canonical\" href=\"https:\/\/golangbyexamples.com\/defer-methods-golang\/\" \/>\n<meta property=\"og:locale\" content=\"en_US\" \/>\n<meta property=\"og:type\" content=\"article\" \/>\n<meta property=\"og:title\" content=\"Defer and Methods in Go (Golang) - Welcome To Golang By Example\" \/>\n<meta property=\"og:description\" content=\"Table of Contents OverviewExample Overview defer statement is also applicable\u00a0 for methods in a similar way it is applicable to functions. Let&#8217;s see an example Example In the above program, we do...\" \/>\n<meta property=\"og:url\" content=\"https:\/\/golangbyexamples.com\/defer-methods-golang\/\" \/>\n<meta property=\"og:site_name\" content=\"Welcome To Golang By Example\" \/>\n<meta property=\"article:published_time\" content=\"2020-09-23T14:06:08+00:00\" \/>\n<meta property=\"article:modified_time\" content=\"2020-09-23T14:06:22+00:00\" \/>\n<meta name=\"author\" content=\"admin\" \/>\n<meta name=\"twitter:card\" content=\"summary_large_image\" \/>\n<meta name=\"twitter:label1\" content=\"Written by\" \/>\n\t<meta name=\"twitter:data1\" content=\"admin\" \/>\n\t<meta name=\"twitter:label2\" content=\"Est. reading time\" \/>\n\t<meta name=\"twitter:data2\" content=\"3 minutes\" \/>\n<script type=\"application\/ld+json\" class=\"yoast-schema-graph\">{\"@context\":\"https:\/\/schema.org\",\"@graph\":[{\"@type\":\"WebPage\",\"@id\":\"https:\/\/golangbyexamples.com\/defer-methods-golang\/\",\"url\":\"https:\/\/golangbyexamples.com\/defer-methods-golang\/\",\"name\":\"Defer and Methods in Go (Golang) - Welcome To Golang By Example\",\"isPartOf\":{\"@id\":\"https:\/\/golangbyexamples.com\/#website\"},\"datePublished\":\"2020-09-23T14:06:08+00:00\",\"dateModified\":\"2020-09-23T14:06:22+00:00\",\"author\":{\"@id\":\"https:\/\/golangbyexamples.com\/#\/schema\/person\/8833ea7638dafd763cb1db6c0ca4576f\"},\"breadcrumb\":{\"@id\":\"https:\/\/golangbyexamples.com\/defer-methods-golang\/#breadcrumb\"},\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"ReadAction\",\"target\":[\"https:\/\/golangbyexamples.com\/defer-methods-golang\/\"]}]},{\"@type\":\"BreadcrumbList\",\"@id\":\"https:\/\/golangbyexamples.com\/defer-methods-golang\/#breadcrumb\",\"itemListElement\":[{\"@type\":\"ListItem\",\"position\":1,\"name\":\"Home\",\"item\":\"https:\/\/golangbyexamples.com\/\"},{\"@type\":\"ListItem\",\"position\":2,\"name\":\"Defer and Methods in Go (Golang)\"}]},{\"@type\":\"WebSite\",\"@id\":\"https:\/\/golangbyexamples.com\/#website\",\"url\":\"https:\/\/golangbyexamples.com\/\",\"name\":\"Welcome To Golang By Example\",\"description\":\"\",\"potentialAction\":[{\"@type\":\"SearchAction\",\"target\":{\"@type\":\"EntryPoint\",\"urlTemplate\":\"https:\/\/golangbyexamples.com\/?s={search_term_string}\"},\"query-input\":\"required name=search_term_string\"}],\"inLanguage\":\"en-US\"},{\"@type\":\"Person\",\"@id\":\"https:\/\/golangbyexamples.com\/#\/schema\/person\/8833ea7638dafd763cb1db6c0ca4576f\",\"name\":\"admin\",\"image\":{\"@type\":\"ImageObject\",\"inLanguage\":\"en-US\",\"@id\":\"https:\/\/golangbyexamples.com\/#\/schema\/person\/image\/\",\"url\":\"https:\/\/secure.gravatar.com\/avatar\/?s=96&d=mm&r=g\",\"contentUrl\":\"https:\/\/secure.gravatar.com\/avatar\/?s=96&d=mm&r=g\",\"caption\":\"admin\"},\"url\":\"https:\/\/golangbyexamples.com\/author\/admin\/\"}]}<\/script>\n<!-- \/ Yoast SEO plugin. -->","yoast_head_json":{"title":"Defer and Methods in Go (Golang) - Welcome To Golang By Example","robots":{"index":"index","follow":"follow","max-snippet":"max-snippet:-1","max-image-preview":"max-image-preview:large","max-video-preview":"max-video-preview:-1"},"canonical":"https:\/\/golangbyexamples.com\/defer-methods-golang\/","og_locale":"en_US","og_type":"article","og_title":"Defer and Methods in Go (Golang) - Welcome To Golang By Example","og_description":"Table of Contents OverviewExample Overview defer statement is also applicable\u00a0 for methods in a similar way it is applicable to functions. Let&#8217;s see an example Example In the above program, we do...","og_url":"https:\/\/golangbyexamples.com\/defer-methods-golang\/","og_site_name":"Welcome To Golang By Example","article_published_time":"2020-09-23T14:06:08+00:00","article_modified_time":"2020-09-23T14:06:22+00:00","author":"admin","twitter_card":"summary_large_image","twitter_misc":{"Written by":"admin","Est. reading time":"3 minutes"},"schema":{"@context":"https:\/\/schema.org","@graph":[{"@type":"WebPage","@id":"https:\/\/golangbyexamples.com\/defer-methods-golang\/","url":"https:\/\/golangbyexamples.com\/defer-methods-golang\/","name":"Defer and Methods in Go (Golang) - Welcome To Golang By Example","isPartOf":{"@id":"https:\/\/golangbyexamples.com\/#website"},"datePublished":"2020-09-23T14:06:08+00:00","dateModified":"2020-09-23T14:06:22+00:00","author":{"@id":"https:\/\/golangbyexamples.com\/#\/schema\/person\/8833ea7638dafd763cb1db6c0ca4576f"},"breadcrumb":{"@id":"https:\/\/golangbyexamples.com\/defer-methods-golang\/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https:\/\/golangbyexamples.com\/defer-methods-golang\/"]}]},{"@type":"BreadcrumbList","@id":"https:\/\/golangbyexamples.com\/defer-methods-golang\/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https:\/\/golangbyexamples.com\/"},{"@type":"ListItem","position":2,"name":"Defer and Methods in Go (Golang)"}]},{"@type":"WebSite","@id":"https:\/\/golangbyexamples.com\/#website","url":"https:\/\/golangbyexamples.com\/","name":"Welcome To Golang By Example","description":"","potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https:\/\/golangbyexamples.com\/?s={search_term_string}"},"query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"Person","@id":"https:\/\/golangbyexamples.com\/#\/schema\/person\/8833ea7638dafd763cb1db6c0ca4576f","name":"admin","image":{"@type":"ImageObject","inLanguage":"en-US","@id":"https:\/\/golangbyexamples.com\/#\/schema\/person\/image\/","url":"https:\/\/secure.gravatar.com\/avatar\/?s=96&d=mm&r=g","contentUrl":"https:\/\/secure.gravatar.com\/avatar\/?s=96&d=mm&r=g","caption":"admin"},"url":"https:\/\/golangbyexamples.com\/author\/admin\/"}]}},"jetpack_featured_media_url":"","jetpack_publicize_connections":[],"jetpack_sharing_enabled":true,"jetpack_shortlink":"https:\/\/wp.me\/paOs1b-13D","amp_validity":null,"amp_enabled":true,"_links":{"self":[{"href":"https:\/\/golangbyexamples.com\/wp-json\/wp\/v2\/posts\/4069","targetHints":{"allow":["GET"]}}],"collection":[{"href":"https:\/\/golangbyexamples.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/golangbyexamples.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/golangbyexamples.com\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/golangbyexamples.com\/wp-json\/wp\/v2\/comments?post=4069"}],"version-history":[{"count":1,"href":"https:\/\/golangbyexamples.com\/wp-json\/wp\/v2\/posts\/4069\/revisions"}],"predecessor-version":[{"id":4070,"href":"https:\/\/golangbyexamples.com\/wp-json\/wp\/v2\/posts\/4069\/revisions\/4070"}],"wp:attachment":[{"href":"https:\/\/golangbyexamples.com\/wp-json\/wp\/v2\/media?parent=4069"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/golangbyexamples.com\/wp-json\/wp\/v2\/categories?post=4069"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/golangbyexamples.com\/wp-json\/wp\/v2\/tags?post=4069"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}