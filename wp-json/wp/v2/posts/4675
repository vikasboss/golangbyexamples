{"id":4675,"date":"2020-12-10T02:04:54","date_gmt":"2020-12-09T20:34:54","guid":{"rendered":"https:\/\/golangbyexamples.com\/?p=4675"},"modified":"2020-12-14T23:47:19","modified_gmt":"2020-12-14T18:17:19","slug":"set-headers-http-request","status":"publish","type":"post","link":"https:\/\/golangbyexamples.com\/set-headers-http-request\/","title":{"rendered":"Set request headers for an outgoing HTTP request in Go (Golang)"},"content":{"rendered":"\n<p class=\"has-medium-font-size\">Note: Related Post<\/p>\n\n\n\n<ul class=\"has-medium-font-size wp-block-list\"><li>Get headers from an incoming HTTP request in Go \u2013&nbsp;<a href=\"https:\/\/golangbyexamples.com\/headers-http-request-golang\/\">https:\/\/golangbyexamples.com\/headers-http-request-golang\/<\/a><\/li><\/ul>\n\n\n\n<ul class=\"has-medium-font-size wp-block-list\"><li>Set response headers for an incoming HTTP request in Go (Golang) \u2013&nbsp;<a href=\"https:\/\/golangbyexamples.com\/set-resposne-headers-http-go\/\">https:\/\/golangbyexamples.com\/set-resposne-headers-http-go\/<\/a><\/li><\/ul>\n\n\n\n<ul class=\"has-medium-font-size wp-block-list\"><li>Get response headers for an outgoing HTTP request in Golang- <a href=\"https:\/\/golangbyexamples.com\/get-response-headers-making-go\/\">https:\/\/golangbyexamples.com\/get-response-headers-making-go\/<\/a><\/li><\/ul>\n\n\n\n<p class=\"has-medium-font-size\">Now let\u2019s look at how we can set headers while making a HTTP request<\/p>\n\n\n\n<div id=\"ez-toc-container\" class=\"ez-toc-v2_0_17 counter-hierarchy counter-decimal ez-toc-light-blue\">\n<div class=\"ez-toc-title-container\">\n<p class=\"ez-toc-title\">Table of Contents<\/p>\n<span class=\"ez-toc-title-toggle\"><a class=\"ez-toc-pull-right ez-toc-btn ez-toc-btn-xs ez-toc-btn-default ez-toc-toggle\" style=\"display: none;\"><i class=\"ez-toc-glyphicon ez-toc-icon-toggle\"><\/i><\/a><\/span><\/div>\n<nav><ul class=\"ez-toc-list ez-toc-list-level-1\"><li class=\"ez-toc-page-1 ez-toc-heading-level-1\"><a class=\"ez-toc-link ez-toc-heading-1\" href=\"https:\/\/golangbyexamples.com\/set-headers-http-request\/#Overview\" title=\"Overview\">Overview<\/a><\/li><li class=\"ez-toc-page-1 ez-toc-heading-level-1\"><a class=\"ez-toc-link ez-toc-heading-2\" href=\"https:\/\/golangbyexamples.com\/set-headers-http-request\/#Using_rHeaderAdd_method\" title=\"Using r.Header.Add() method\">Using r.Header.Add() method<\/a><\/li><li class=\"ez-toc-page-1 ez-toc-heading-level-1\"><a class=\"ez-toc-link ez-toc-heading-3\" href=\"https:\/\/golangbyexamples.com\/set-headers-http-request\/#Using_rHeaderSet_method\" title=\"Using r.Header.Set method\">Using r.Header.Set method<\/a><\/li><li class=\"ez-toc-page-1 ez-toc-heading-level-1\"><a class=\"ez-toc-link ez-toc-heading-4\" href=\"https:\/\/golangbyexamples.com\/set-headers-http-request\/#Example\" title=\"Example\">Example<\/a><\/li><\/ul><\/nav><\/div>\n<h1 class=\"wp-block-heading\"><span class=\"ez-toc-section\" id=\"Overview\"><\/span><strong>Overview<\/strong><span class=\"ez-toc-section-end\"><\/span><\/h1>\n\n\n\n<p class=\"has-medium-font-size\">Below is the format in which a Header is represented in go.<\/p>\n\n\n\n<pre class=\"wp-block-prismatic-blocks\"><code class=\"language-go\">type Header map[string][]string<\/code><\/pre>\n\n\n\n<p class=\"has-medium-font-size\">So the header is a key value pair with<\/p>\n\n\n\n<ul class=\"has-medium-font-size wp-block-list\"><li>key being represented in canonical form. Canonical form means that first character and any character following a hyphen is in uppercase. All other characters is in lowercase. Example of canonical forms are<\/li><\/ul>\n\n\n\n<pre class=\"wp-block-prismatic-blocks\"><code class=\"language-go\">Content-Type\nAccept-Encoding<\/code><\/pre>\n\n\n\n<ul class=\"has-medium-font-size wp-block-list\"><li>Value is represented as a slice of string. Why array of strings? Because it is perfectly okay to two headers with same key and different values in a request. Both the values will be collected in the slice.<\/li><\/ul>\n\n\n\n<p class=\"has-medium-font-size\">For eg if below headers are set in the outgoing request from a client then<\/p>\n\n\n\n<pre class=\"wp-block-prismatic-blocks\"><code class=\"language-go\">user-agent: goapplication\nfoo: bar1\nfoo: bar2<\/code><\/pre>\n\n\n\n<p class=\"has-medium-font-size\">Then at server the headers will look like<\/p>\n\n\n\n<pre class=\"wp-block-prismatic-blocks\"><code class=\"language-go\">User-Agent: goapplication\nFoo: bar1\nFoo: bar2<\/code><\/pre>\n\n\n\n<p>Notice that:<\/p>\n\n\n\n<ul class=\"has-medium-font-size wp-block-list\"><li><strong>user-agent<\/strong> is converted to canonical form <strong>User-Agent<\/strong><\/li><li><strong>foo<\/strong> header is converted to <strong>Foo<\/strong>. Also note that there will be two headers that will be set in the request with the same key which is <strong>foo<\/strong>. The values will be <strong>bar1<\/strong> and <strong>bar2<\/strong><\/li><\/ul>\n\n\n\n<p class=\"has-medium-font-size\">Now we have seen how a header is represented in the request. Let&#8217;s see how we can set the request headers values when making HTTP requests. Assume we have the below key value pairs of headers which we have to set in the HTTP request<\/p>\n\n\n\n<pre class=\"wp-block-prismatic-blocks\"><code class=\"language-go\">user-agent: goapplication\nfoo: bar1\nfoo: bar2<\/code><\/pre>\n\n\n\n<p class=\"has-medium-font-size\"><strong>Header<\/strong> is present within the <strong>http.Request<\/strong> struct like as below.<\/p>\n\n\n\n<pre class=\"wp-block-prismatic-blocks\"><code class=\"language-go\">type Request struct {\n    Method string\n    Header Header\n    ...\n}<\/code><\/pre>\n\n\n\n<p class=\"has-medium-font-size\">In the below example let&#8217;s assume that variable <strong>r<\/strong> of type *<strong>http.Request<\/strong> type. Now let&#8217;s see different ways of setting a header<\/p>\n\n\n\n<h1 class=\"wp-block-heading\"><span class=\"ez-toc-section\" id=\"Using_rHeaderAdd_method\"><\/span><strong>Using r.Header.Add() method<\/strong><span class=\"ez-toc-section-end\"><\/span><\/h1>\n\n\n\n<p class=\"has-medium-font-size\">Below is the signature of the Add method<\/p>\n\n\n\n<pre class=\"wp-block-prismatic-blocks\"><code class=\"language-go\">func (h Header) Add(key, value string)<\/code><\/pre>\n\n\n\n<p class=\"has-medium-font-size\">This method is used to add the key value pair to the request header. We have already seen above that Header value can be array as well. So this method appends to the existing values that might already have been associated with the key.&nbsp; Also the key will be converted to canonical form. For example if we add the foo header two times with different values<\/p>\n\n\n\n<pre class=\"wp-block-prismatic-blocks\"><code class=\"language-go\">r.Header.Add(\"foo\", \"bar1\")\nr.Header.Add(\"foo\", \"bar2\")<\/code><\/pre>\n\n\n\n<p class=\"has-medium-font-size\">Then <strong>foo<\/strong> header will be set to<strong> [&#8220;bar1&#8221;, &#8220;bar2&#8221;]. <\/strong>Also <strong>foo<\/strong> will become <strong>Foo<\/strong> before making the http call<\/p>\n\n\n\n<h1 class=\"wp-block-heading\"><span class=\"ez-toc-section\" id=\"Using_rHeaderSet_method\"><\/span><strong>Using r.Header.Set method<\/strong><span class=\"ez-toc-section-end\"><\/span><\/h1>\n\n\n\n<p class=\"has-medium-font-size\">Below is the signature of the function<\/p>\n\n\n\n<pre class=\"wp-block-prismatic-blocks\"><code class=\"language-go\">func (h Header) Set(key, value string)<\/code><\/pre>\n\n\n\n<p class=\"has-medium-font-size\">It can be used to set the header entries associated with the given key. Unlike the <strong>Add<\/strong> method, this method will replace any existing values associated with the key. Also the key will be converted to canonical form.<\/p>\n\n\n\n<h1 class=\"wp-block-heading\"><span class=\"ez-toc-section\" id=\"Example\"><\/span><strong>Example<\/strong><span class=\"ez-toc-section-end\"><\/span><\/h1>\n\n\n\n<p class=\"has-medium-font-size\">Let&#8217;s see a program illustrating all the above points<\/p>\n\n\n\n<pre class=\"wp-block-prismatic-blocks\"><code class=\"language-go\">package main\nimport (\n    \"fmt\"\n    \"net\/http\"\n    \"time\"\n)\nfunc main() {\n    call(\"https:\/\/google.com\", \"GET\")\n}\nfunc call(url, method string) error {\n    client := &http.Client{\n        Timeout: time.Second * 10,\n    }\n    req, err := http.NewRequest(method, url, nil)\n    if err != nil {\n        return fmt.Errorf(\"Got error %s\", err.Error())\n    }\n    req.Header.Set(\"user-agent\", \"golang application\")\n    req.Header.Add(\"foo\", \"bar1\")\n    req.Header.Add(\"foo\", \"bar2\")\n    response, err := client.Do(req)\n    if err != nil {\n        return fmt.Errorf(\"Got error %s\", err.Error())\n    }\n    defer response.Body.Close()\n    return nil\n}<\/code><\/pre>\n\n\n\n<p class=\"has-medium-font-size\">Note in the above example how we are setting the headers while making the HTTP call<\/p>\n\n\n\n<pre class=\"wp-block-prismatic-blocks\"><code class=\"language-\">req.Header.Set(\"user-agent\", \"goapplication\")\nreq.Header.Add(\"foo\", \"bar1\")\nreq.Header.Add(\"foo\", \"bar2\")<\/code><\/pre>\n","protected":false},"excerpt":{"rendered":"<p>Note: Related Post Get headers from an incoming HTTP request in Go \u2013&nbsp;https:\/\/golangbyexamples.com\/headers-http-request-golang\/ Set response headers for an incoming HTTP request in Go (Golang) \u2013&nbsp;https:\/\/golangbyexamples.com\/set-resposne-headers-http-go\/ Get response headers for an outgoing HTTP&#8230;<\/p>\n","protected":false},"author":1,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"spay_email":"","footnotes":"","jetpack_publicize_message":"","jetpack_is_tweetstorm":false},"categories":[1],"tags":[3,4],"class_list":["post-4675","post","type-post","status-publish","format-standard","hentry","category-tech","tag-go","tag-golang"],"yoast_head":"<!-- This site is optimized with the Yoast SEO plugin v22.7 - https:\/\/yoast.com\/wordpress\/plugins\/seo\/ -->\n<title>Set request headers for an outgoing HTTP request in Go (Golang) - Welcome To Golang By Example<\/title>\n<meta name=\"robots\" content=\"index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1\" \/>\n<link rel=\"canonical\" href=\"https:\/\/golangbyexamples.com\/set-headers-http-request\/\" \/>\n<meta property=\"og:locale\" content=\"en_US\" \/>\n<meta property=\"og:type\" content=\"article\" \/>\n<meta property=\"og:title\" content=\"Set request headers for an outgoing HTTP request in Go (Golang) - Welcome To Golang By Example\" \/>\n<meta property=\"og:description\" content=\"Note: Related Post Get headers from an incoming HTTP request in Go \u2013&nbsp;https:\/\/golangbyexamples.com\/headers-http-request-golang\/ Set response headers for an incoming HTTP request in Go (Golang) \u2013&nbsp;https:\/\/golangbyexamples.com\/set-resposne-headers-http-go\/ Get response headers for an outgoing HTTP...\" \/>\n<meta property=\"og:url\" content=\"https:\/\/golangbyexamples.com\/set-headers-http-request\/\" \/>\n<meta property=\"og:site_name\" content=\"Welcome To Golang By Example\" \/>\n<meta property=\"article:published_time\" content=\"2020-12-09T20:34:54+00:00\" \/>\n<meta property=\"article:modified_time\" content=\"2020-12-14T18:17:19+00:00\" \/>\n<meta name=\"author\" content=\"admin\" \/>\n<meta name=\"twitter:card\" content=\"summary_large_image\" \/>\n<meta name=\"twitter:label1\" content=\"Written by\" \/>\n\t<meta name=\"twitter:data1\" content=\"admin\" \/>\n\t<meta name=\"twitter:label2\" content=\"Est. reading time\" \/>\n\t<meta name=\"twitter:data2\" content=\"3 minutes\" \/>\n<script type=\"application\/ld+json\" class=\"yoast-schema-graph\">{\"@context\":\"https:\/\/schema.org\",\"@graph\":[{\"@type\":\"WebPage\",\"@id\":\"https:\/\/golangbyexamples.com\/set-headers-http-request\/\",\"url\":\"https:\/\/golangbyexamples.com\/set-headers-http-request\/\",\"name\":\"Set request headers for an outgoing HTTP request in Go (Golang) - Welcome To Golang By Example\",\"isPartOf\":{\"@id\":\"https:\/\/golangbyexamples.com\/#website\"},\"datePublished\":\"2020-12-09T20:34:54+00:00\",\"dateModified\":\"2020-12-14T18:17:19+00:00\",\"author\":{\"@id\":\"https:\/\/golangbyexamples.com\/#\/schema\/person\/8833ea7638dafd763cb1db6c0ca4576f\"},\"breadcrumb\":{\"@id\":\"https:\/\/golangbyexamples.com\/set-headers-http-request\/#breadcrumb\"},\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"ReadAction\",\"target\":[\"https:\/\/golangbyexamples.com\/set-headers-http-request\/\"]}]},{\"@type\":\"BreadcrumbList\",\"@id\":\"https:\/\/golangbyexamples.com\/set-headers-http-request\/#breadcrumb\",\"itemListElement\":[{\"@type\":\"ListItem\",\"position\":1,\"name\":\"Home\",\"item\":\"https:\/\/golangbyexamples.com\/\"},{\"@type\":\"ListItem\",\"position\":2,\"name\":\"Set request headers for an outgoing HTTP request in Go (Golang)\"}]},{\"@type\":\"WebSite\",\"@id\":\"https:\/\/golangbyexamples.com\/#website\",\"url\":\"https:\/\/golangbyexamples.com\/\",\"name\":\"Welcome To Golang By Example\",\"description\":\"\",\"potentialAction\":[{\"@type\":\"SearchAction\",\"target\":{\"@type\":\"EntryPoint\",\"urlTemplate\":\"https:\/\/golangbyexamples.com\/?s={search_term_string}\"},\"query-input\":\"required name=search_term_string\"}],\"inLanguage\":\"en-US\"},{\"@type\":\"Person\",\"@id\":\"https:\/\/golangbyexamples.com\/#\/schema\/person\/8833ea7638dafd763cb1db6c0ca4576f\",\"name\":\"admin\",\"image\":{\"@type\":\"ImageObject\",\"inLanguage\":\"en-US\",\"@id\":\"https:\/\/golangbyexamples.com\/#\/schema\/person\/image\/\",\"url\":\"https:\/\/secure.gravatar.com\/avatar\/?s=96&d=mm&r=g\",\"contentUrl\":\"https:\/\/secure.gravatar.com\/avatar\/?s=96&d=mm&r=g\",\"caption\":\"admin\"},\"url\":\"https:\/\/golangbyexamples.com\/author\/admin\/\"}]}<\/script>\n<!-- \/ Yoast SEO plugin. -->","yoast_head_json":{"title":"Set request headers for an outgoing HTTP request in Go (Golang) - Welcome To Golang By Example","robots":{"index":"index","follow":"follow","max-snippet":"max-snippet:-1","max-image-preview":"max-image-preview:large","max-video-preview":"max-video-preview:-1"},"canonical":"https:\/\/golangbyexamples.com\/set-headers-http-request\/","og_locale":"en_US","og_type":"article","og_title":"Set request headers for an outgoing HTTP request in Go (Golang) - Welcome To Golang By Example","og_description":"Note: Related Post Get headers from an incoming HTTP request in Go \u2013&nbsp;https:\/\/golangbyexamples.com\/headers-http-request-golang\/ Set response headers for an incoming HTTP request in Go (Golang) \u2013&nbsp;https:\/\/golangbyexamples.com\/set-resposne-headers-http-go\/ Get response headers for an outgoing HTTP...","og_url":"https:\/\/golangbyexamples.com\/set-headers-http-request\/","og_site_name":"Welcome To Golang By Example","article_published_time":"2020-12-09T20:34:54+00:00","article_modified_time":"2020-12-14T18:17:19+00:00","author":"admin","twitter_card":"summary_large_image","twitter_misc":{"Written by":"admin","Est. reading time":"3 minutes"},"schema":{"@context":"https:\/\/schema.org","@graph":[{"@type":"WebPage","@id":"https:\/\/golangbyexamples.com\/set-headers-http-request\/","url":"https:\/\/golangbyexamples.com\/set-headers-http-request\/","name":"Set request headers for an outgoing HTTP request in Go (Golang) - Welcome To Golang By Example","isPartOf":{"@id":"https:\/\/golangbyexamples.com\/#website"},"datePublished":"2020-12-09T20:34:54+00:00","dateModified":"2020-12-14T18:17:19+00:00","author":{"@id":"https:\/\/golangbyexamples.com\/#\/schema\/person\/8833ea7638dafd763cb1db6c0ca4576f"},"breadcrumb":{"@id":"https:\/\/golangbyexamples.com\/set-headers-http-request\/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https:\/\/golangbyexamples.com\/set-headers-http-request\/"]}]},{"@type":"BreadcrumbList","@id":"https:\/\/golangbyexamples.com\/set-headers-http-request\/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https:\/\/golangbyexamples.com\/"},{"@type":"ListItem","position":2,"name":"Set request headers for an outgoing HTTP request in Go (Golang)"}]},{"@type":"WebSite","@id":"https:\/\/golangbyexamples.com\/#website","url":"https:\/\/golangbyexamples.com\/","name":"Welcome To Golang By Example","description":"","potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https:\/\/golangbyexamples.com\/?s={search_term_string}"},"query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"Person","@id":"https:\/\/golangbyexamples.com\/#\/schema\/person\/8833ea7638dafd763cb1db6c0ca4576f","name":"admin","image":{"@type":"ImageObject","inLanguage":"en-US","@id":"https:\/\/golangbyexamples.com\/#\/schema\/person\/image\/","url":"https:\/\/secure.gravatar.com\/avatar\/?s=96&d=mm&r=g","contentUrl":"https:\/\/secure.gravatar.com\/avatar\/?s=96&d=mm&r=g","caption":"admin"},"url":"https:\/\/golangbyexamples.com\/author\/admin\/"}]}},"jetpack_featured_media_url":"","jetpack_publicize_connections":[],"jetpack_sharing_enabled":true,"jetpack_shortlink":"https:\/\/wp.me\/paOs1b-1dp","amp_validity":null,"amp_enabled":true,"_links":{"self":[{"href":"https:\/\/golangbyexamples.com\/wp-json\/wp\/v2\/posts\/4675","targetHints":{"allow":["GET"]}}],"collection":[{"href":"https:\/\/golangbyexamples.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/golangbyexamples.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/golangbyexamples.com\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/golangbyexamples.com\/wp-json\/wp\/v2\/comments?post=4675"}],"version-history":[{"count":6,"href":"https:\/\/golangbyexamples.com\/wp-json\/wp\/v2\/posts\/4675\/revisions"}],"predecessor-version":[{"id":4725,"href":"https:\/\/golangbyexamples.com\/wp-json\/wp\/v2\/posts\/4675\/revisions\/4725"}],"wp:attachment":[{"href":"https:\/\/golangbyexamples.com\/wp-json\/wp\/v2\/media?parent=4675"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/golangbyexamples.com\/wp-json\/wp\/v2\/categories?post=4675"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/golangbyexamples.com\/wp-json\/wp\/v2\/tags?post=4675"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}