{"id":4943,"date":"2021-01-17T10:23:55","date_gmt":"2021-01-17T04:53:55","guid":{"rendered":"https:\/\/golangbyexamples.com\/?p=4943"},"modified":"2021-01-17T18:04:40","modified_gmt":"2021-01-17T12:34:40","slug":"resposne-body-closed-golang","status":"publish","type":"post","link":"https:\/\/golangbyexamples.com\/resposne-body-closed-golang\/","title":{"rendered":"Why response body is closed in golang"},"content":{"rendered":"\n<p class=\"has-medium-font-size\">The response body should be closed after the response is fully read. This is done to prevent resource leak of connections. If the response body is not closed then the connection will not be released and hence it cannot be reused. From the official docs of <strong>http.Client<\/strong><\/p>\n\n\n\n<p class=\"has-medium-font-size\">From the official docs of<strong> http.Client<\/strong><\/p>\n\n\n\n<p class=\"has-medium-font-size\"><a href=\"https:\/\/golang.org\/pkg\/net\/http\/#Client\">https:\/\/golang.org\/pkg\/net\/http\/#Client<\/a><\/p>\n\n\n\n<p>If the Body is not both read to EOF and closed, the Client&#8217;s underlying RoundTripper (typically Transport) may not be able to re-use a persistent TCP connection to the server for a subsequent &#8220;keep-alive&#8221; request.<\/p>\n\n\n\n<p class=\"has-medium-font-size\">So essentially, transport may not reuse HTTP\/1.x &#8220;keep-alive&#8221; TCP connections if the Body is not read to completion and closed.The <strong>response.Body<\/strong> implements the <strong>io.ReadCloser<\/strong> interface.<\/p>\n\n\n\n<p class=\"has-medium-font-size\">Also to mention that it is the caller&#8217;s responsibility to close the response body<\/p>\n\n\n\n<p class=\"has-medium-font-size\">Some important guidelines to follow&nbsp;<\/p>\n\n\n\n<ul class=\"has-medium-font-size wp-block-list\"><li>Use the defer method to close the response body. This is done to make sure that the response body gets closed even in case of runtime error during reading and parsing of response.<\/li><\/ul>\n\n\n\n<ul class=\"has-medium-font-size wp-block-list\"><li>Check for error first always. Only proceed to close the response body using defer if the error is nil. A nil error always indicates a non-nil response body. If the error is non-nil then handle that error and return. Also, note that closing a nil response body will cause a panic.<\/li><\/ul>\n\n\n\n<p class=\"has-medium-font-size\">A simple example<\/p>\n\n\n\n<pre class=\"wp-block-prismatic-blocks\"><code class=\"language-go\">resp, err := http.Get(\"http:\/\/google.com\/\")\nif err != nil {\n    \/\/Handle the error here.\n    return\n}\ndefer resp.Body.Close()\n\/\/Read and parse response body here<\/code><\/pre>\n\n\n\n<p class=\"has-medium-font-size\">Above is a simple example of how to handle HTTP error and when to close a response body. See how in the example we are closing the resp.Body using the defer function. And the response body is only closed if the error is nil<\/p>\n","protected":false},"excerpt":{"rendered":"<p>The response body should be closed after the response is fully read. This is done to prevent resource leak of connections. If the response body is not closed then the connection will&#8230;<\/p>\n","protected":false},"author":1,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"spay_email":"","footnotes":"","jetpack_publicize_message":"","jetpack_is_tweetstorm":false},"categories":[1],"tags":[3,4],"class_list":["post-4943","post","type-post","status-publish","format-standard","hentry","category-tech","tag-go","tag-golang"],"yoast_head":"<!-- This site is optimized with the Yoast SEO plugin v22.7 - https:\/\/yoast.com\/wordpress\/plugins\/seo\/ -->\n<title>Why response body is closed in golang - Welcome To Golang By Example<\/title>\n<meta name=\"robots\" content=\"index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1\" \/>\n<link rel=\"canonical\" href=\"https:\/\/golangbyexamples.com\/resposne-body-closed-golang\/\" \/>\n<meta property=\"og:locale\" content=\"en_US\" \/>\n<meta property=\"og:type\" content=\"article\" \/>\n<meta property=\"og:title\" content=\"Why response body is closed in golang - Welcome To Golang By Example\" \/>\n<meta property=\"og:description\" content=\"The response body should be closed after the response is fully read. This is done to prevent resource leak of connections. If the response body is not closed then the connection will...\" \/>\n<meta property=\"og:url\" content=\"https:\/\/golangbyexamples.com\/resposne-body-closed-golang\/\" \/>\n<meta property=\"og:site_name\" content=\"Welcome To Golang By Example\" \/>\n<meta property=\"article:published_time\" content=\"2021-01-17T04:53:55+00:00\" \/>\n<meta property=\"article:modified_time\" content=\"2021-01-17T12:34:40+00:00\" \/>\n<meta name=\"author\" content=\"admin\" \/>\n<meta name=\"twitter:card\" content=\"summary_large_image\" \/>\n<meta name=\"twitter:label1\" content=\"Written by\" \/>\n\t<meta name=\"twitter:data1\" content=\"admin\" \/>\n\t<meta name=\"twitter:label2\" content=\"Est. reading time\" \/>\n\t<meta name=\"twitter:data2\" content=\"2 minutes\" \/>\n<script type=\"application\/ld+json\" class=\"yoast-schema-graph\">{\"@context\":\"https:\/\/schema.org\",\"@graph\":[{\"@type\":\"WebPage\",\"@id\":\"https:\/\/golangbyexamples.com\/resposne-body-closed-golang\/\",\"url\":\"https:\/\/golangbyexamples.com\/resposne-body-closed-golang\/\",\"name\":\"Why response body is closed in golang - Welcome To Golang By Example\",\"isPartOf\":{\"@id\":\"https:\/\/golangbyexamples.com\/#website\"},\"datePublished\":\"2021-01-17T04:53:55+00:00\",\"dateModified\":\"2021-01-17T12:34:40+00:00\",\"author\":{\"@id\":\"https:\/\/golangbyexamples.com\/#\/schema\/person\/8833ea7638dafd763cb1db6c0ca4576f\"},\"breadcrumb\":{\"@id\":\"https:\/\/golangbyexamples.com\/resposne-body-closed-golang\/#breadcrumb\"},\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"ReadAction\",\"target\":[\"https:\/\/golangbyexamples.com\/resposne-body-closed-golang\/\"]}]},{\"@type\":\"BreadcrumbList\",\"@id\":\"https:\/\/golangbyexamples.com\/resposne-body-closed-golang\/#breadcrumb\",\"itemListElement\":[{\"@type\":\"ListItem\",\"position\":1,\"name\":\"Home\",\"item\":\"https:\/\/golangbyexamples.com\/\"},{\"@type\":\"ListItem\",\"position\":2,\"name\":\"Why response body is closed in golang\"}]},{\"@type\":\"WebSite\",\"@id\":\"https:\/\/golangbyexamples.com\/#website\",\"url\":\"https:\/\/golangbyexamples.com\/\",\"name\":\"Welcome To Golang By Example\",\"description\":\"\",\"potentialAction\":[{\"@type\":\"SearchAction\",\"target\":{\"@type\":\"EntryPoint\",\"urlTemplate\":\"https:\/\/golangbyexamples.com\/?s={search_term_string}\"},\"query-input\":\"required name=search_term_string\"}],\"inLanguage\":\"en-US\"},{\"@type\":\"Person\",\"@id\":\"https:\/\/golangbyexamples.com\/#\/schema\/person\/8833ea7638dafd763cb1db6c0ca4576f\",\"name\":\"admin\",\"image\":{\"@type\":\"ImageObject\",\"inLanguage\":\"en-US\",\"@id\":\"https:\/\/golangbyexamples.com\/#\/schema\/person\/image\/\",\"url\":\"https:\/\/secure.gravatar.com\/avatar\/?s=96&d=mm&r=g\",\"contentUrl\":\"https:\/\/secure.gravatar.com\/avatar\/?s=96&d=mm&r=g\",\"caption\":\"admin\"},\"url\":\"https:\/\/golangbyexamples.com\/author\/admin\/\"}]}<\/script>\n<!-- \/ Yoast SEO plugin. -->","yoast_head_json":{"title":"Why response body is closed in golang - Welcome To Golang By Example","robots":{"index":"index","follow":"follow","max-snippet":"max-snippet:-1","max-image-preview":"max-image-preview:large","max-video-preview":"max-video-preview:-1"},"canonical":"https:\/\/golangbyexamples.com\/resposne-body-closed-golang\/","og_locale":"en_US","og_type":"article","og_title":"Why response body is closed in golang - Welcome To Golang By Example","og_description":"The response body should be closed after the response is fully read. This is done to prevent resource leak of connections. If the response body is not closed then the connection will...","og_url":"https:\/\/golangbyexamples.com\/resposne-body-closed-golang\/","og_site_name":"Welcome To Golang By Example","article_published_time":"2021-01-17T04:53:55+00:00","article_modified_time":"2021-01-17T12:34:40+00:00","author":"admin","twitter_card":"summary_large_image","twitter_misc":{"Written by":"admin","Est. reading time":"2 minutes"},"schema":{"@context":"https:\/\/schema.org","@graph":[{"@type":"WebPage","@id":"https:\/\/golangbyexamples.com\/resposne-body-closed-golang\/","url":"https:\/\/golangbyexamples.com\/resposne-body-closed-golang\/","name":"Why response body is closed in golang - Welcome To Golang By Example","isPartOf":{"@id":"https:\/\/golangbyexamples.com\/#website"},"datePublished":"2021-01-17T04:53:55+00:00","dateModified":"2021-01-17T12:34:40+00:00","author":{"@id":"https:\/\/golangbyexamples.com\/#\/schema\/person\/8833ea7638dafd763cb1db6c0ca4576f"},"breadcrumb":{"@id":"https:\/\/golangbyexamples.com\/resposne-body-closed-golang\/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https:\/\/golangbyexamples.com\/resposne-body-closed-golang\/"]}]},{"@type":"BreadcrumbList","@id":"https:\/\/golangbyexamples.com\/resposne-body-closed-golang\/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https:\/\/golangbyexamples.com\/"},{"@type":"ListItem","position":2,"name":"Why response body is closed in golang"}]},{"@type":"WebSite","@id":"https:\/\/golangbyexamples.com\/#website","url":"https:\/\/golangbyexamples.com\/","name":"Welcome To Golang By Example","description":"","potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https:\/\/golangbyexamples.com\/?s={search_term_string}"},"query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"Person","@id":"https:\/\/golangbyexamples.com\/#\/schema\/person\/8833ea7638dafd763cb1db6c0ca4576f","name":"admin","image":{"@type":"ImageObject","inLanguage":"en-US","@id":"https:\/\/golangbyexamples.com\/#\/schema\/person\/image\/","url":"https:\/\/secure.gravatar.com\/avatar\/?s=96&d=mm&r=g","contentUrl":"https:\/\/secure.gravatar.com\/avatar\/?s=96&d=mm&r=g","caption":"admin"},"url":"https:\/\/golangbyexamples.com\/author\/admin\/"}]}},"jetpack_featured_media_url":"","jetpack_publicize_connections":[],"jetpack_sharing_enabled":true,"jetpack_shortlink":"https:\/\/wp.me\/paOs1b-1hJ","amp_validity":null,"amp_enabled":true,"_links":{"self":[{"href":"https:\/\/golangbyexamples.com\/wp-json\/wp\/v2\/posts\/4943","targetHints":{"allow":["GET"]}}],"collection":[{"href":"https:\/\/golangbyexamples.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/golangbyexamples.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/golangbyexamples.com\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/golangbyexamples.com\/wp-json\/wp\/v2\/comments?post=4943"}],"version-history":[{"count":2,"href":"https:\/\/golangbyexamples.com\/wp-json\/wp\/v2\/posts\/4943\/revisions"}],"predecessor-version":[{"id":4945,"href":"https:\/\/golangbyexamples.com\/wp-json\/wp\/v2\/posts\/4943\/revisions\/4945"}],"wp:attachment":[{"href":"https:\/\/golangbyexamples.com\/wp-json\/wp\/v2\/media?parent=4943"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/golangbyexamples.com\/wp-json\/wp\/v2\/categories?post=4943"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/golangbyexamples.com\/wp-json\/wp\/v2\/tags?post=4943"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}